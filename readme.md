# LLM Inverse Kinematics

This repository is the base for generating prompts and executing code for testing the [inverse kinematics](https://en.wikipedia.org/wiki/Inverse_kinematics "Inverse Kinematics Wikipedia") generated by LLMs for [serial manipulators](https://en.wikipedia.org/wiki/Serial_manipulator "Serial Manipulators Wikipedia"). Serial manipulators, or robot arms, are a kinematic chain with a single "end effector", and often have six joints as that is what is required to reach all places in a 3D space.

## Background

There are multiple ways to solve inverse kinematics.
1. Numerical/iterative solvers which try to converge to a solution. These are very popular but have the problem of failing to converge by getting stuck in a local minima. Popular libraries such as [IKPy](https://github.com/Phylliade/ikpy "IKPy") use these methods. Even the Robot [Operating System (ROS)](https://www.ros.org "ROS - Robot Operating System") uses the [KDL solver](https://wiki.ros.org/kdl "KDL Solver") which is of this type of solver by default.
2. Machine learning techniques taken approaches at solving this. [Bio IK](https://d-nb.info/1221720910/34 "Bio IK") is one of the best, and I built [Fusion IK](https://stevenrice.ca/fusion-ik "Fusion IK Demo") on top of it which improves its effectiveness on extended kinematic chains. However, most of these lack repeatability given their evolutionary nature, and repeatability is something we want for robotics.
3. Analytical solvers solve generate closed-form solutions by solving complex equations to complete the inverse kinematics. This is most often done by hand by experts. The only program which can do this is [IKFast](https://moveit.picknik.ai/main/doc/examples/ikfast/ikfast_tutorial.html "MoveIt IKFast") can generate C++ code for six or seven degrees-of-freedom robots in a few minutes but fails beyond that.

## Goal

- Get an LLM to consistently produce successful inverse kinematics solutions across multiple serial manipulators.
- These could at first be numerical solutions, as even their math is complex.
- However, as numerical solvers already exist in most languages as packages, this would not be very useful for practical use, as it would more or less just show that an LLM can comprehend how to do this method.
- The overall goal would be to get analytical solutions being produced.
- We could compare the effectiveness of the solutions both in terms of their accuracy and execution time.

## Significance

- Inverse kinematics are hard to solve and require a great deal of understanding of the subject. An LLM being able to comprehend the structure of a kinematic chain and further solve the inverse kinematics would show a very high degree of understanding and complex problem-solving.

## Progress

- Robots can be parsed and tested with a standard numerical solver.
- **However, GPT-3.5, GPT-4o, and GPT-4 have all failed with multiple prompt attempts so far.** I have ChatGPT Plus which is where I tested these three models. There is no direct API calls to any LLMs thus far, and all communication has been via copying and pasting to and from ChatGPT.
- These prompts have tried giving minimal information about the robot via parsing of joint data before adding it to the prompt, as well as attempting to send entire [URDF](https://en.wikipedia.org/wiki/URDF "URDF Wikipedia") files in the prompts as well. All attempts so far have failed. The reality is that no LLMs may be capable of solving inverse kinematics of serial manipulators yet.
- **All of my tests have been done on a [Universal Robots UR5e](https://www.universal-robots.com/products/ur5-robot, "Universal Robots UR5e").**

## Ideas

- While not as interesting as they do not have as much use, we could potentially try on kinematic chains smaller than a standard serial manipulator.
- Trying to solve the inverse kinematics on kinematic chains of two or three joints may be more feasible by current LLMs.
- If this is the case, we will need to construct them which can be done as seen in the XML files under the "Models" folder, where each subfolder is for a robot which has a "Model.xml". These models were taken from the [Mujoco Model Gallery](https://mujoco.readthedocs.io/en/stable/models.html "Mujoco Model Gallery").

## Usage

- "main.py" has all methods. Running this script will test all IK solutions for a given robot in reaching a random position and orientation. It is currently set to the [Universal Robots UR5e](https://www.universal-robots.com/products/ur5-robot, "Universal Robots UR5e").
- "prompt.py" will output a prompt to the console for you to give to LLMs. The contents of the prompt are composed of a static start and end found in "prompt_start.txt" and "prompt_end.txt" respectively, and between them a dynamic portion of the prompt is input consisting of information about the robot.